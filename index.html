<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <title>Automated Repair of Exploits in NETGEAR Router Binary</title>
    <link rel="stylesheet" type="text/css" href="etc/netgear-repair.css" />
  </head>
  <body>
    <h1>Automated Repair of Exploits in NETGEAR Router Binary</h1>

    <p>NETGEAR's WNDR3700 [1] is a very popular wireless router.  Version 4
      of the WNDR3700 contains exploits allowing unauthenticated users to
      change administrative options and completely disable authentication
      across reboots (see [2] for a full description of the exploits).</p>

    <p>We fixed these exploits using a method of automated program repair
      which operates directly on binary ELF files and requires no access to
      source code [3].  This fix was found before NETGEAR addressed these
      exploits---to my knowledge NETGEAR has not yet patched these exploits
      in the latest release of the firmware 1.0.1.42 as of 2013-11-19.</p>

    <p>The exploits exist in the WNDR3700's web interface.  A single ELF
      executable CGI file serves this interface and applies configuration
      changes made using the interface to the router.  Using copies of the
      NETGEAR firmware running in virtual machines to evaluate the fitness
      of candidate repairs, our technique discovered changes to this ELF
      file which patch the exploits described in [2].</p>

    <p>This repository contains the instructions, code, and tooling used to
      develop this repair.  These tools may be used to automatically change
      the behavior other binary ELF executables, making it possible to fix
      customize and alter binaries executables without any aid from the
      software's developer.</p>

    <p>An article describing the exploit, the repair technique, its
      application, and the repairs found is available at [4].  Source
      code and step by step instructions required to reproduce this
      repair are given in [5] and [6] respectively.</p>

    <p>Thanks to Zachary Cutlip for help reproducing these exploits in a VM.</p>

    <p>Footnotes:</p>
    <p>[1]  <a href="http://www.netgear.com/home/products/networking/wifi-routers/wndr3700.aspx">http://www.netgear.com/home/products/networking/wifi-routers/wndr3700.aspx</a></p>

    <p>[2]  <a href="http://shadow-file.blogspot.com/2013/10/complete-persistent-compromise-of.html">http://shadow-file.blogspot.com/2013/10/complete-persistent-compromise-of.html</a></p>

    <p>[3]  <a href="http://cs.unm.edu/~eschulte/data/schulte2013embedded.pdf">http://cs.unm.edu/~eschulte/data/schulte2013embedded.pdf</a></p>

    <p>[4]  <a href="http://eschulte.github.io/netgear-repair/pub/netgear-repair.html">http://eschulte.github.io/netgear-repair/pub/netgear-repair.html</a></p>

    <p>[5]  <a href="http://github.com/eschulte/netgear-repair">http://github.com/eschulte/netgear-repair</a></p>

    <p>[6]  <a href="INSTRUCTIONS.html">INSTRUCTIONS</a></p>
  </body>
</html>
